# POC-MarketPredictor-ML Technical Specification

**Version:** 0.9.0  
**Last Updated:** February 2025  
**Status:** Beta â€“ simulation + ranking flows implemented, hardening in progress

---

## 1. System Overview

POC-MarketPredictor-ML is a FastAPI + React application for ranking equities/crypto and simulating trades. Core modules:

- **Backend** (`market_predictor/`)
  - `server.py`: FastAPI entry point exposing ranking, prediction, watchlist, and simulation endpoints.
  - `trading.py`: Trading and ranking logic that powers `/ranking` and related routes.
  - `simulation.py` + `simulation_db.py`: Paper-trading engine and SQLite persistence (migration to PostgreSQL planned).
  - `crypto.py`, `alerts.py`, `websocket.py`: Crypto rankings, alerting hooks, and live updates.
  - `services.py`, `cache.py`, `database.py`: Shared service wiring, caching, and data access helpers.
- **Frontend** (`frontend/`)
  - React (Vite) app that consumes `/ranking`, `/predict_ticker/{ticker}`, and simulation endpoints.
  - Dark/light theme, localization support, and watchlist UI.
- **Training / Jobs** (`training/`, `scripts/`)
  - Model training and evaluation helpers plus CLI scripts for data refreshes.

---

## 2. API Surface (v0.9.0)

- **Ranking & Prediction**: `/ranking`, `/predict_ticker/{ticker}`, `/ticker_info/{ticker}`
- **Crypto**: `/crypto/ranking`, `/crypto/details/{crypto_id}`, `/crypto/search`
- **Simulation (beta)**: `/api/simulations` CRUD + recommendations, trades, history, portfolio, and reset endpoints
- **Health & Metrics**: `/health`, `/prometheus`

The OpenAPI schema is generated by FastAPI in `server.py`; expand endpoint descriptions as part of the P0 documentation task.

---

## 3. Data & Persistence

- **SQLite** is currently used for simulations and watchlists via lightweight helpers in `simulation_db.py` and `database.py`.
- **Planned**: Migration to PostgreSQL managed through SQLAlchemy migrations with rollback guidance.
- **Caching**: Optional Redis cache (see `cache.py`) to reduce duplicate lookups.

---

## 4. Trading Logic (Simulation)

- Buys when confidence exceeds configured threshold; sells on low confidence, stop-loss, or take-profit triggers.
- Maintains a capped number of open positions and equal-weight allocation.
- Persists simulations, trades, and positions; refresh cycle handled via API calls.

Add regression tests for these rules as outlined in `docs/project/backlog.md`.

---

## 5. Deployment & Operations

- Containerized via Dockerfile; `docker-compose.yml` wires backend + frontend.
- `render.yaml`, `railway.toml`, and `netlify.toml` provide hosted deployment templates.
- **Next steps**: finalize environment profiles (dev/stage/prod), add structured logging for simulations, and validate deployments with smoke tests.

---

## 6. Documentation Map

- Backlog & priorities: `docs/project/backlog.md`
- Getting started: `README.md` and `docs/getting-started/index.md`
- Deployment: `docs/deployment/DEPLOYMENT_GUIDE.md`
- Historical context: `docs/history/` (kept for reference)
